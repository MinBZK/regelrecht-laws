$id: https://raw.githubusercontent.com/MinBZK/poc-machine-law/refs/heads/main/schema/v0.1.6/schema.json
uuid: 7b2c4d8e-3f91-4a6b-9c5e-8d7f6a5b4c3d
name: Bestuursorgaan Definitie
law: algemene_wet_bestuursrecht
article: "1:1"
discoverable: "BUSINESS"
valid_from: 1994-01-01
service: "AWB"

properties:
  parameters:
    - name: "ORGANISATIE_ID"
      type: "string"
      required: true

  sources:
    - name: "IS_ORGAAN_VAN_RECHTSPERSOON"
      type: "boolean"
      source_reference:
        source_type: "AWB"
        table: "organisaties"
        field: "is_orgaan_van_rechtspersoon"
        select_on:
          - name: "organisatie_id"
            type: "string"
            value: "$ORGANISATIE_ID"

    - name: "PUBLIEKRECHTELIJKE_RECHTSPERSOON_TYPE"
      type: "string"
      source_reference:
        source_type: "AWB"
        table: "organisaties"
        field: "publiekrechtelijke_rechtspersoon_type"
        select_on:
          - name: "organisatie_id"
            type: "string"
            value: "$ORGANISATIE_ID"

    - name: "HEEFT_PUBLIEKRECHTELIJKE_BEVOEGDHEID"
      type: "boolean"
      source_reference:
        source_type: "AWB"
        table: "organisaties"
        field: "heeft_publiekrechtelijke_bevoegdheid"
        select_on:
          - name: "organisatie_id"
            type: "string"
            value: "$ORGANISATIE_ID"

    - name: "BEVOEGDHEID_BIJ_OF_KRACHTENS_WET"
      type: "boolean"
      source_reference:
        source_type: "AWB"
        table: "organisaties"
        field: "bevoegdheid_bij_of_krachtens_wet"
        select_on:
          - name: "organisatie_id"
            type: "string"
            value: "$ORGANISATIE_ID"

    - name: "OVERHEIDSFINANCIERING_PERCENTAGE"
      type: "number"
      type_spec:
        unit: "percentage"
        precision: 2
        min: 0
        max: 100
      source_reference:
        source_type: "AWB"
        table: "organisaties"
        field: "overheidsfinanciering_percentage"
        select_on:
          - name: "organisatie_id"
            type: "string"
            value: "$ORGANISATIE_ID"

    - name: "CRITERIA_DOOR_OVERHEID_BEPAALD"
      type: "boolean"
      source_reference:
        source_type: "AWB"
        table: "organisaties"
        field: "criteria_door_overheid_bepaald"
        select_on:
          - name: "organisatie_id"
            type: "string"
            value: "$ORGANISATIE_ID"

    - name: "IS_UITSLUITEND_FINANCIELE_UITKERING"
      type: "boolean"
      source_reference:
        source_type: "AWB"
        table: "organisaties"
        field: "is_uitsluitend_financiele_uitkering"
        select_on:
          - name: "organisatie_id"
            type: "string"
            value: "$ORGANISATIE_ID"

    - name: "IS_VOLKSVERTEGENWOORDIGEND_ORGAAN"
      type: "boolean"
      source_reference:
        source_type: "AWB"
        table: "organisaties"
        field: "is_volksvertegenwoordigend_orgaan"
        select_on:
          - name: "organisatie_id"
            type: "string"
            value: "$ORGANISATIE_ID"

    - name: "IS_RECHTERLIJK_ORGAAN"
      type: "boolean"
      source_reference:
        source_type: "AWB"
        table: "organisaties"
        field: "is_rechterlijk_orgaan"
        select_on:
          - name: "organisatie_id"
            type: "string"
            value: "$ORGANISATIE_ID"

    - name: "IS_OMBUDSMAN"
      type: "boolean"
      source_reference:
        source_type: "AWB"
        table: "organisaties"
        field: "is_ombudsman"
        select_on:
          - name: "organisatie_id"
            type: "string"
            value: "$ORGANISATIE_ID"

    - name: "IS_ALGEMENE_REKENKAMER"
      type: "boolean"
      source_reference:
        source_type: "AWB"
        table: "organisaties"
        field: "is_algemene_rekenkamer"
        select_on:
          - name: "organisatie_id"
            type: "string"
            value: "$ORGANISATIE_ID"

  output:
    - name: "is_bestuursorgaan"
      type: "boolean"
      citizen_relevance: primary

    - name: "bestuursorgaan_type"
      type: "string"
      citizen_relevance: secondary

    - name: "exclusion_reason"
      type: "string"
      citizen_relevance: secondary

    - name: "is_excluded"
      type: "boolean"
      citizen_relevance: secondary

    - name: "qualifies_as_bestuursorgaan"
      type: "boolean"
      citizen_relevance: secondary

    - name: "is_a_orgaan"
      type: "boolean"
      citizen_relevance: secondary

    - name: "is_b_orgaan"
      type: "boolean"
      citizen_relevance: secondary

  definitions:
    TWEE_DERDE_DREMPEL: 66.67

actions:
  # First check exclusions - if any is true, not a bestuursorgaan
  - output: "is_excluded"
    operation: OR
    values:
      - subject: "$IS_VOLKSVERTEGENWOORDIGEND_ORGAAN"
        operation: EQUALS
        value: true
      - subject: "$IS_RECHTERLIJK_ORGAAN"
        operation: EQUALS
        value: true
      - subject: "$IS_OMBUDSMAN"
        operation: EQUALS
        value: true
      - subject: "$IS_ALGEMENE_REKENKAMER"
        operation: EQUALS
        value: true

  # Check if qualifies as bestuursorgaan (ignoring exclusions for now)
  - output: "qualifies_as_bestuursorgaan"
    operation: OR
    values:
      # A-organen (Article 1:1 lid 1 sub a)
      - operation: AND
        values:
          - subject: "$IS_ORGAAN_VAN_RECHTSPERSOON"
            operation: EQUALS
            value: true
          - subject: "$PUBLIEKRECHTELIJKE_RECHTSPERSOON_TYPE"
            operation: IN
            values:
              - "RIJK"
              - "PROVINCIE"
              - "WATERSCHAP"
              - "GEMEENTE"
              - "OPENBAAR_LICHAAM"
      # B-organen non-financial (Article 1:1 lid 1 sub b)
      - operation: AND
        values:
          - subject: "$HEEFT_PUBLIEKRECHTELIJKE_BEVOEGDHEID"
            operation: EQUALS
            value: true
          - subject: "$BEVOEGDHEID_BIJ_OF_KRACHTENS_WET"
            operation: EQUALS
            value: true
          - subject: "$IS_UITSLUITEND_FINANCIELE_UITKERING"
            operation: EQUALS
            value: false
      # B-organen financial (two-thirds rule)
      - operation: AND
        values:
          - subject: "$IS_UITSLUITEND_FINANCIELE_UITKERING"
            operation: EQUALS
            value: true
          - subject: "$OVERHEIDSFINANCIERING_PERCENTAGE"
            operation: GREATER_OR_EQUAL
            value: "$TWEE_DERDE_DREMPEL"
          - subject: "$CRITERIA_DOOR_OVERHEID_BEPAALD"
            operation: EQUALS
            value: true

  # Final: is_bestuursorgaan = qualifies AND NOT excluded
  - output: "is_bestuursorgaan"
    operation: AND
    values:
      - subject: "$qualifies_as_bestuursorgaan"
        operation: EQUALS
        value: true
      - subject: "$is_excluded"
        operation: NOT_EQUALS
        value: true

  # Determine if A-orgaan
  - output: "is_a_orgaan"
    operation: AND
    values:
      - subject: "$IS_ORGAAN_VAN_RECHTSPERSOON"
        operation: EQUALS
        value: true
      - subject: "$PUBLIEKRECHTELIJKE_RECHTSPERSOON_TYPE"
        operation: IN
        values:
          - "RIJK"
          - "PROVINCIE"
          - "WATERSCHAP"
          - "GEMEENTE"
          - "OPENBAAR_LICHAAM"

  # Determine if B-orgaan
  - output: "is_b_orgaan"
    operation: OR
    values:
      - operation: AND
        values:
          - subject: "$HEEFT_PUBLIEKRECHTELIJKE_BEVOEGDHEID"
            operation: EQUALS
            value: true
          - subject: "$BEVOEGDHEID_BIJ_OF_KRACHTENS_WET"
            operation: EQUALS
            value: true
          - subject: "$IS_UITSLUITEND_FINANCIELE_UITKERING"
            operation: EQUALS
            value: false
      - operation: AND
        values:
          - subject: "$IS_UITSLUITEND_FINANCIELE_UITKERING"
            operation: EQUALS
            value: true
          - subject: "$OVERHEIDSFINANCIERING_PERCENTAGE"
            operation: GREATER_OR_EQUAL
            value: "$TWEE_DERDE_DREMPEL"
          - subject: "$CRITERIA_DOOR_OVERHEID_BEPAALD"
            operation: EQUALS
            value: true

  # Compute bestuursorgaan_type - default to GEEN_BESTUURSORGAAN
  - output: "bestuursorgaan_type"
    value: "GEEN_BESTUURSORGAAN"

  #  Override if A-orgaan and bestuursorgaan
  - output: "bestuursorgaan_type"
    condition:
      operation: AND
      values:
        - subject: "$is_bestuursorgaan"
          operation: EQUALS
          value: true
        - subject: "$is_a_orgaan"
          operation: EQUALS
          value: true
    operation: STATIC
    value: "A_ORGAAN"

  # Override if B-orgaan and bestuursorgaan  
  - output: "bestuursorgaan_type"
    condition:
      operation: AND
      values:
        - subject: "$is_bestuursorgaan"
          operation: EQUALS
          value: true
        - subject: "$is_b_orgaan"
          operation: EQUALS
          value: true
    operation: STATIC
    value: "B_ORGAAN"

  # Compute exclusion_reason
  - output: "exclusion_reason"
    condition:
      subject: "$IS_VOLKSVERTEGENWOORDIGEND_ORGAAN"
      operation: EQUALS
      value: true
    operation: STATIC
    value: "VOLKSVERTEGENWOORDIGEND_ORGAAN"

  - output: "exclusion_reason"
    condition:
      subject: "$IS_RECHTERLIJK_ORGAAN"
      operation: EQUALS
      value: true
    operation: STATIC
    value: "RECHTERLIJK_ORGAAN"

  - output: "exclusion_reason"
    condition:
      subject: "$IS_OMBUDSMAN"
      operation: EQUALS
      value: true
    operation: STATIC
    value: "OMBUDSMAN"

  - output: "exclusion_reason"
    condition:
      subject: "$IS_ALGEMENE_REKENKAMER"
      operation: EQUALS
      value: true
    operation: STATIC
    value: "ALGEMENE_REKENKAMER"
